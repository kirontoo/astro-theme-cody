---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/Base.astro';
import { getUniqueTagsWithCount } from '@/utils';

const posts = (await getCollection('blog', ({data}) => {
		return import.meta.env.PROD ? data.draft !== true : true;
}));
const tags = getUniqueTagsWithCount(posts);
---

<BaseLayout title="All Tags">
	<h1 class="flex font-bold text-xl items-center mb-4"> 
		<svg
			aria-hidden="true"
			xmlns="http://www.w3.org/2000/svg"
			class="h-6 w-6"
			viewBox="0 0 24 24"
			stroke-width="1.5"
			stroke="currentColor"
			fill="none"
			stroke-linecap="round"
			stroke-linejoin="round"
			>
			<path stroke="none" d="M0 0h24v24H0z" fill="none" />
			<path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z" />
			<path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116" />
			<path d="M6 9h-.01" />
		</svg>
		Tags
	</h1>
	<ul>
		{tags.map(([tag, count]) => (
			<li class="my-2">
				<a class="cody-link" href={`/tags/${tag}`}>#{tag}</a>
				({count})
			</li>
		))}
	</ul>
</BaseLayout>
